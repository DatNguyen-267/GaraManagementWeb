
<link rel="stylesheet" href="/css/employeeManagerment.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<title>Nghỉ phép và vi phạm</title>
    <div class = "grid__content">
      <header class = "employeeManagerment__header">
        <h1 class = "template__title">Nghỉ phép và vi phạm</h1>
        <div class="toolbar">
          <div class="toolbar__search">
            <input class="toolbar__search-input" style="padding:.4rem" type="search " id = "searchKey" placeholder="Tìm kiếm thông tin nhân viên" aria-label="Search" onkeyup="search()">
            <span class="ti-search toolbar__search-icon"> </span>
          </div>
        </div>
      </header>
      <body class = "employeeManagerment__body">
          <div class = "table-responsive">
            <table class="table table--default employeeManagerment__body__table" id = "managerTable">
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Họ và Tên</th>
                    <th scope="col">Chức vụ</th>
                    <th scope="col">Số lần vi phạm</th>
                    <th scope="col">Số ngày nghỉ</th>
                  </tr>
                </thead>
                <tbody>
                  {{#each data}}
                  <tr employeeID = "{{this.employee._id}}" employeeNumber = "{{this.employee.phoneNumber}}">
                    <th scope="row">{{sum @index 1}}</th>
                    <td id = "employeeName">{{this.employee.name}}</td>
                    <td>{{this.employee.Tag}}</td>
                    <td>{{this.errorCount}}</td>
                    <td>{{this.dateoffCount}}</td>  
                  </tr>
                  {{/each}}
              </table> 
        </div>
            

            <!--Add modal-->
              <form method="POST" action="employeeList/create">
              <div class="modal fade " id="addModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered infoModal" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Thêm nhân viên</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body" id =  "test">
                    <form>
                      <div class="form-group">
                        <label for="reception-add-lincense" class="col-form-label">Tên nhân viên:</label>
                        <input type="text" class="form-control" name="name">
                      </div>
                      <div class="form-group">
                        <label for="reception-add-phone" class="col-form-label">Địa chỉ:</label>
                        <input type="text" class="form-control" name="address">
                      </div>
                      <div class="form-group">
                        <label for="reception-add-brand" class="col-form-label">Số điện thoại</label>
                        <input type="text" class="form-control" name="phoneNumber">
                      </div>
                      <div class="form-group">
                        <label for="reception-add-receptionDate" class="col-form-label">Email:</label>
                        <input type="text" class="form-control" name="email">
                      </div>
                      <div class="form-group">
                        <label for="reception-add-receptionDate" class="col-form-label">CMND:</label>
                        <input type="text" class="form-control" name="CMND">
                      </div>
                      <div class="form-group">
                        <label for="reception-add-receptionDate" class="col-form-label">Chức vụ:</label>
                        <select class = "form-control" name="Tag" placeholder="">
                              <option value= "" disabled selected>Chọn loại nhân viên</option>
                              {{#each tag}}
                                <option value="{{this.name}}">{{this.name}}</option>
                              {{/each}}
                        </select>
                      </div>
                    </form>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
                    <button type="summit" class="btn btn-primary" onclick="add()">Thêm</button>
                  </div>
                </div>
              </div>
            </div>
            </form>
            <form method = "GET" name = "info-form"></form>
      </body>
    </div>


    <script>
      var employeeID;
      var id;
      var infoForm = document.forms['info-form'];
      function search(){
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("searchKey");
        filter = input.value;
        table = document.getElementById("employeeTable");
        tr = $("tbody tr");
        for (i = 0; i < tr.length; i++) {
          var td1 = tr[i].getElementsByTagName("td")[0];
          if (td1) {
            txtValue = td1.textContent || td1.innerText;
            filter = filter.toUpperCase();
            txtValue = txtValue.toUpperCase();
            if (txtValue.includes(filter)) {
              tr[i].style.display = "";
            } else {
              tr[i].style.display = "none";
            }
          }   
        }
      }
      $('#managerTable tbody tr').click(function () {
        id = $(this).attr('employeeID')
        $('#info_employeeName').text("Tên nhân viên: " + $(this).children('#employeeName').text());
        $('#info_phoneNumber').text("SĐT: " + $(this).attr('employeeNumber'));
        infoForm.action = 'employeeManagerment/' + id + '/info'
        infoForm.submit();
      });
      function modified(){
        
      };

      document.addEventListener('DOMContentLoaded', function () {
    });
    </script>